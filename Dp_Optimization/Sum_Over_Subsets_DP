ll a[1 << NMAX], S[1 << NMAX], dp[1 << NMAX][NMAX];

// naive iterative
for(int mask = 0; mask < (1 << n); mask++){
    dp[mask][0] = a[mask];
    for(int i = 0; i < n; i++){
        dp[mask][i + 1] = dp[mask][i];
        if(mask & (1 << i)) dp[mask][i] += dp[mask ^ (1 << i)][i - 1];
    }
    S[mask] = dp[mask][n];
}
